from flask import Flask, request
import telebot
import os

app = Flask(__name__)
bot = telebot.TeleBot(os.getenv("TELEGRAM_TOKEN"))

@app.route("/", methods=["GET"])
def home():
    return "SmartHeart 45 –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç!"

@app.route("/set_webhook", methods=["GET"])
def set_webhook():
    bot.remove_webhook()
    bot.set_webhook(url=os.getenv("BOT_BASE_URL") + "/webhook")
    return "Webhook set!"

@app.route("/webhook", methods=["POST"])
def webhook():
    update = telebot.types.Update.de_json(request.stream.read().decode("utf-8"))
    bot.process_new_updates([update])
    return "OK", 200

@bot.message_handler(commands=['start'])
def start_handler(message):
    intro_text = """üíì *HeartAge 45*

–ê–Ω—Ç–∏—ç–π–¥–∂ –∏ —Å–Ω–∏–∂–µ–Ω–∏–µ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞ –∑–∞ 45 –¥–Ω–µ–π  
–°–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Å–∞ –∏ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞ –±–µ–∑ –≥–æ–ª–æ–¥–∞ –∏ –∫—Ä–∞–π–Ω–æ—Å—Ç–µ–π

üî¨ *–ß—Ç–æ —Ç–∞–∫–æ–µ HeartAge 45?*  
HeartAge 45 ‚Äî —ç—Ç–æ –∞–≤—Ç–æ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –ø–∏—Ç–∞–Ω–∏—è –æ—Ç –∫–∞—Ä–¥–∏–æ–ª–æ–≥–∞ –û–ª—å–≥–∏ –ë–æ–∫–µ—Ä–∏—è, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –Ω–µ –ø—Ä–æ—Å—Ç–æ –ø–æ—Ö—É–¥–µ—Ç—å, –∞ –∑–∞–º–µ–¥–ª–∏—Ç—å —Å—Ç–∞—Ä–µ–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–º–∞, —Å–Ω–∏–∑–∏—Ç—å —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω –∏ —É–ª—É—á—à–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ —Å–µ—Ä–¥—Ü–∞ –∏ —Å–æ—Å—É–¥–æ–≤ ‚Äî –±–µ–∑ —Å—Ç—Ä–æ–≥–∏—Ö –¥–∏–µ—Ç –∏ –∏—Å—Ç–æ—â–∞—é—â–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.  
–≠—Ç–æ 45-–¥–Ω–µ–≤–Ω—ã–π –Ω–∞—É—á–Ω–æ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è —Å —á–µ—Ç–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π, —É–¥–æ–±–Ω—ã–º –º–µ–Ω—é –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –ø–æ–¥ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—É—é –∂–∏–∑–Ω—å.

üí° *–î–ª—è –∫–æ–≥–æ —ç—Ç–æ—Ç –ø–ª–∞–Ω:*  
‚Äî –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç –ø–æ—Ö—É–¥–µ—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ  
‚Äî –î–ª—è –ª—é–¥–µ–π —Å –ø–æ–≤—ã—à–µ–Ω–Ω—ã–º —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–æ–º, –¥–∞–≤–ª–µ–Ω–∏–µ–º –∏–ª–∏ —Å–∞—Ö–∞—Ä–æ–º  
‚Äî –î–ª—è —Ç–µ—Ö, –∫—Ç–æ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∑–∞–º–µ–¥–ª–∏—Ç—å —Å—Ç–∞—Ä–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–ª–æ–¥–æ—Å—Ç—å  
‚Äî –î–ª—è –∑–∞–Ω—è—Ç—ã—Ö, –∫—Ç–æ —Ö–æ—á–µ—Ç —á—ë—Ç–∫—É—é —Å–∏—Å—Ç–µ–º—É –±–µ–∑ –ø–æ–¥—Å—á—ë—Ç–∞ –∫–∞–ª–æ—Ä–∏–π –∏ —Å—Ç—Ä–µ—Å—Å–∞  

ü•ó *–ß—Ç–æ –≤–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º–∞:*  
‚Äî –ü–æ–¥—Ä–æ–±–Ω–æ–µ –º–µ–Ω—é –Ω–∞ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å  
‚Äî –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–µ–∂–∏–º—É, –≤–æ–¥–µ, –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –±–∏–æ—Ö–∞–∫–∏–Ω–≥—É  
‚Äî –ü—Ä–æ–¥—É–∫—Ç—ã, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ –∑–¥–æ—Ä–æ–≤—å–µ —Å–æ—Å—É–¥–æ–≤, –º–æ–∑–≥–∞ –∏ –∫–æ–∂–∏  
‚Äî –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è: –ø–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ —Ç–∞–∫ –∏ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –æ—Ä–≥–∞–Ω–∏–∑–º–µ  

üîÑ *–†–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã—Ö –º–æ–∂–Ω–æ –æ–∂–∏–¥–∞—Ç—å:*  
‚Äî –°–Ω–∏–∂–µ–Ω–∏–µ –≤–µ—Å–∞ –æ—Ç 4 –¥–æ 7 –∫–≥  
‚Äî –°–Ω–∏–∂–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø–ª–æ—Ö–æ–≥–æ —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω–∞ (LDL)  
‚Äî –ü–æ–≤—ã—à–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏, —É–ª—É—á—à–µ–Ω–∏–µ —Å–Ω–∞ –∏ –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏—è  
‚Äî –°–Ω–∏–∂–µ–Ω–∏–µ –≤–æ—Å–ø–∞–ª–µ–Ω–∏—è –∏ –æ–º–æ–ª–æ–∂–µ–Ω–∏–µ –∫–æ–∂–∏

üöÄ *–ù–µ –∂–¥–∏—Ç–µ!* –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å —Å–µ–≥–æ–¥–Ω—è –∏ –ø–æ–≤–µ—Ä–Ω–∏—Ç–µ –≤—Ä–µ–º—è –≤—Å–ø—è—Ç—å!
"""
    bot.send_message(message.chat.id, intro_text, parse_mode="Markdown")

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
if __name__ == "__main__":
    app.run(host="0.0.0.0", port=8080, debug=True)